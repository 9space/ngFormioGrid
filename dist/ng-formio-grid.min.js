!function e(i,t,n){function r(a,s){if(!t[a]){if(!i[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=t[a]={exports:{}};i[a][0].call(u.exports,function(e){var t=i[a][1][e];return r(t?t:e)},u,u.exports,e,i,t,n)}return t[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,i,t){"use strict";angular.module("ngFormioGrid",["formio","ngSanitize","ui.grid","ui.grid.pagination","ui.grid.resizeColumns","ui.grid.autoResize","ui.grid.selection"]).directive("formioGridCell",["$compile","formioTableView",function(e,i){return{restrict:"E",scope:{data:"=",component:"="},link:function(e,t){e.$watch("data",function(n){var r=i(n,e.component);Array.isArray(r)&&(r=r.join(", ")),t.html(r)})}}}]).directive("formioGrid",function(){return{restrict:"E",replace:!0,scope:{src:"=",query:"=?",aggregate:"=?",columns:"=?",buttons:"=?",gridOptions:"=?"},template:'<div><div ui-grid="gridOptionsDef" ui-grid-pagination ui-grid-auto-resize ui-grid-resize-columns ui-grid-move-columns ui-grid-selection class="grid"></div></div>',controller:["$scope","$element","$timeout","Formio","formioComponents","FormioUtils","uiGridConstants","$http",function(e,i,t,n,r,o,a,s){var l=null,c={pageNumber:1,pageSize:25,sort:null};e.query&&e.query.sort&&(c.sort=e.query.sort);var u={},d=function(){u=e.columns,Array.isArray(e.columns)&&(u={},e.columns.forEach(function(e){"string"==typeof e?u[e]={}:u[e.key]=e}))};d();var g=function(e,i){switch(e.direction){case a.ASC:c.sort=i;break;case a.DESC:c.sort="-"+i;break;case void 0:c.sort=null}};e.gridOptionsDef=angular.merge({namespace:"row",dataRoot:"data.",responseData:"",responseTotal:"",endpoint:"",paginationPageSizes:[25,50,75],paginationPageSize:c.pageSize,enableHorizontalScrollbar:a.scrollbars.NEVER,enableVerticalScrollbar:a.scrollbars.NEVER,useExternalPagination:!0,useExternalSorting:!0,enableRowSelection:!1,enableRowHeaderSelection:!1,enableFiltering:!0,useExternalFiltering:!0,multiSelect:!1,columnDefs:[],data:[],onRegisterApi:function(i){e.gridApi=i,i.pagination.on.paginationChanged(e,function(e,i){c.pageNumber=e,c.pageSize=i,f()});var t=0;i.core.on.filterChanged(e,function(){var i=this.grid;t&&clearTimeout(t),t=setTimeout(function(){i.columns.forEach(function(i){if(i.colDef&&i.colDef.component&&i.colDef.component.key){var t="";i.filters&&i.filters.length>0&&(t=i.filters[0].term);var n=i.colDef.filterField||"data."+i.colDef.component.key;t?e.query[n+"__regex"]="/"+t+"/i":delete e.query[n+"__regex"]}}),f()},500)});var n=!0;i.core.on.rowsRendered(e,function(){0!==i.grid.renderContainers.body.visibleRowCache.length&&(e.$emit("onGridLoadDone"),n=!1)}),i.selection.on.rowSelectionChanged(e,function(i){e.$emit(e.gridOptionsDef.namespace+"Select",i.entity,i.isSelected)}),i.core.on.sortChanged(e,function(e,i){0===i.length?c.sort=null:g(i[0].sort,i[0].colDef.field),f()})}},e.gridOptions),e.$on("selectGridRow",function(i,t){e.gridApi.selection.selectRow(t)}),c.pageSize=e.gridOptionsDef.paginationPageSize,e.buttons=e.buttons||[],e.buttonClick=function(i,t){e.$emit(i,t)},angular.isUndefined(e.query)&&(e.query={});var f=function(){if(e.gridOptions.columnDefs&&(e.gridOptionsDef.columnDefs=e.gridOptions.columnDefs),c.pageSize&&(e.query.limit=c.pageSize),c.pageNumber&&(e.query.skip=(c.pageNumber-1)*c.pageSize),e.query.sort=c.sort,e.gridOptionsDef.endpoint){var i=e.gridOptionsDef.endpoint,t={headers:{"x-jwt-token":n.getToken()}};if(e.aggregate){var r=angular.copy(e.aggregate),o={};if(angular.forEach(e.query,function(e,i){if(0===i.indexOf("data.")){var t=e.match(/\/([^\/]+)\//);t=t&&t.length>1?t[1]:"",t&&(o[i.replace("__regex","")]={$regex:t,$options:"i"})}}),Object.keys(o).length>0&&r.push({$match:o}),e.query.sort){var a={$sort:{}};if("-"===e.query.sort.charAt(0)){var u=e.query.sort.slice(1);a.$sort[u]=-1,r.push(a)}else a.$sort[e.query.sort]=1,r.push(a)}e.query.limit&&r.push({$limit:e.query.limit}),e.query.skip&&r.push({$skip:e.query.skip}),t.headers["x-query"]=JSON.stringify(r)}else t.params=e.query;s.get(i,t).then(function(i){e.gridOptionsDef.responseData?e.gridOptionsDef.data=i.data[e.gridOptionsDef.responseData]:e.gridOptionsDef.data=i.data,e.gridOptionsDef.responseTotal&&(e.gridOptionsDef.totalItems=i.data[e.gridOptionsDef.responseTotal]),p(i.data.length),e.$emit("onData",i.data)},function(e){console.log("Error: "+e.message)})}else{if(!l)return;e.gridOptionsDef.data=[],l.loadSubmissions({params:e.query}).then(function(i){e.gridOptionsDef.totalItems=i.serverCount,e.gridOptionsDef.data=i,p(i.length),e.$emit("onData",i)})}},p=function(n){return t(function(){var t=e.gridOptions&&e.gridOptions.height?e.gridOptions.height:30*e.gridApi.grid.getVisibleRowCount()+100;angular.element(".grid",i).height(t)},10),n},m=function(){return e.src?(l=new n(e.src),void l.loadForm().then(function(i){d();var t={},n=1;e.gridOptionsDef.columnDefs=e.gridOptions&&e.gridOptions.columnDefs?angular.copy(e.gridOptions.columnDefs):[],e.buttons.forEach(function(i){var n=i["class"]||"btn btn-sm btn-default";t[i.label]=!0,e.gridOptionsDef.columnDefs.unshift({name:i.label,field:i.key,width:i.width,enableFiltering:!1,cellTemplate:'<a class="'+n+'" ng-click="grid.appScope.buttonClick(\''+i.event+'\', row.entity)"><span class="'+i.icon+'" aria-hidden="true"></span>'+i.label+"</a>"})});var r=0,a=function(o,a,s){a=a||{},0!==r||a.hasOwnProperty("link")||(a.link=!0);var l="";if(a.hasOwnProperty("label"))l=a.label;else if(o)for(l=o.label||o.key;t.hasOwnProperty(l);)l=o.label+n++;t[l]=!0;var c=a.template||'<formio-grid-cell class="ui-grid-cell-contents" data="COL_FIELD" component="col.colDef.component"></formio-grid-cell>';if(a.link){var u=a.linkClass,d=a.linkEvent||e.gridOptionsDef.namespace+"View";c='<a class="'+u+'" style="cursor:pointer;" ng-click="grid.appScope.buttonClick(\''+d+"', row.entity)\">"+c+"</a>"}var g=a.field;a.field||(g=o?e.gridOptionsDef.dataRoot+o.key:s);var f={component:o,name:l,field:g,cellTemplate:c,form:i,sort:a.sort,filterField:a.filterField,enableFiltering:!!a.enableFiltering};["width","sortable","visible","minWidth","maxWidth","resizable","cellClass","headerCellClass","headerCellTemplate"].forEach(function(e){a.hasOwnProperty(e)&&(f[e]=a[e])}),e.gridOptionsDef.columnDefs.push(f),r++};if(u&&Object.keys(u).length>0){var s=o.flattenComponents(i.components);angular.forEach(u,function(e,i){if(e.sort&&e.sort.direction){var t=s.hasOwnProperty(i)?"data."+i:i;g(e.sort,t)}a(s[i],e,i)})}else o.eachComponent(i.components,function(e){e.input&&e.tableView&&e.key&&a(e)});f()})):void f()};e.$on("reloadGrid",function(i,t,n){t&&(e.src=t),n&&(e.query=n),m()}),m()}]}})},{}]},{},[1]);